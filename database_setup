Ensure your bot is STOPPED.

Open your terminal.

For /opt/aprsbot-sf/dedup.db:

Bash

sqlite3 /opt/aprsbot-sf/dedup.db
Then, paste these commands into the sqlite3> prompt and press Enter after each:

SQL

CREATE TABLE IF NOT EXISTS deduplication_log (
    frame_hash TEXT PRIMARY KEY,
    timestamp INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS audit_log (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp INTEGER NOT NULL,
    event_type TEXT NOT NULL,
    callsign TEXT NOT NULL,
    details TEXT
);

CREATE TABLE IF NOT EXISTS blacklist (
    callsign TEXT PRIMARY KEY,
    added_at INTEGER NOT NULL,
    reason TEXT
);

CREATE TABLE IF NOT EXISTS admins (
    callsign TEXT PRIMARY KEY,
    added_at INTEGER NOT NULL
);
Type .quit and press Enter to exit.

For /opt/aprsbot-sf/store_forward.db:

Bash

sqlite3 /opt/aprsbot-sf/store_forward.db
Then, paste these commands into the sqlite3> prompt and press Enter after each:

SQL

CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    sender TEXT NOT NULL,
    addressee TEXT NOT NULL,
    message_text TEXT NOT NULL,
    msg_aprs_id TEXT,
    timestamp INTEGER NOT NULL,
    acked BOOLEAN DEFAULT 0,
    delivered_at INTEGER
);

CREATE TABLE IF NOT EXISTS users (
    callsign TEXT PRIMARY KEY,
    last_seen INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS net_members (
    callsign TEXT PRIMARY KEY,
    joined_at INTEGER NOT NULL,
    last_seen INTEGER NOT NULL DEFAULT 0
);
Type .quit and press Enter to exit.

After completing these steps, you can restart your bot. It should now correctly initialize both databases with all the necessary tables in their intended locations.
